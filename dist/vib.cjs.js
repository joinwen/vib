'use strict';

class Action {
  static transform(ele, x, y) {
    ele.style.transform = `translateY(${y}px)`;
  }
}

const getWidth = (ele) => {
  return ele.clientWidth;
};
const getHeight = (ele) => {
  return ele.clientHeight;
};
const getWidthAndHeight = (ele) => {
  return [
    getWidth(ele),
    getHeight(ele)
  ];
};
const getWidthWithBorder = (ele) => {
  return ele.offsetWidth;
};
const getHeightWithBorder = (ele) => {
  return ele.offsetHeight;
};

const getWidthAndHeightWithBorder = (ele) => {
  return [
    getWidthWithBorder(ele),
    getHeightWithBorder(ele)
  ];
};

class TouchTrace {
  constructor(ele) {
    this.ele = ele;
    this.init();
  }
  init() {
    this.x = 0;
    this.y = 0;
    this.position = {};
    this.events = [
      "touchstart",
      "touchmove",
      "touchend",
      "touchcancel"
    ];
    let [ parentWidth,parentHeight ] = getWidthAndHeight(this.ele.parentElement),
      [childWidth, childHeight ] = getWidthAndHeightWithBorder(this.ele);
    this.maxY = parentHeight - childHeight;
    this.maxX = parentWidth - childWidth;
  }
  handleEvent(event) {
    this.generatePositionFromEvent(event);
    switch (event.type) {
    case "touchstart": {
      let startX = this.position.pageX,
        startY = this.position.pageY;
      this.position.startX = startX;
      this.position.startY = startY;
    }break;
    case "touchmove": {
      let moveX = this.position.pageX,
        moveY = this.position.pageY,
        deltaX = moveX - this.position.startX,
        deltaY = moveY - this.position.startY;
      this.position.startX = moveX;
      this.position.startY = moveY;
      this.x = this.x + deltaX;
      this.y = this.y + deltaY;
      if(this.y < this.maxY) {
        this.y = this.maxY;
      }
      if(this.y > 0) {
        this.y = 0;
      }
      Action.transform(this.ele, this.x, this.y);
    }break;
    }
  }
  generatePositionFromEvent(event) {
    let data = event.touches[0];
    this.position.pageX = data.pageX;
    this.position.pageY = data.pageY;
  }
  listen() {
    this.events.forEach(event => {
      this.ele.addEventListener(event, this);
    });
  }
}

const vib = {
  begin: (ele) => {
    let touchTrace = new TouchTrace(ele);
    touchTrace.listen();
  }
};

module.exports = vib;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmliLmNqcy5qcyIsInNvdXJjZXMiOlsiLi4vc3JjL2NvcmUvYWN0aW9uL2luZGV4LmpzIiwiLi4vc3JjL3V0aWxzL2luZGV4LmpzIiwiLi4vc3JjL2NvcmUvdHJhY2UvaW5kZXguanMiLCIuLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgQWN0aW9uIHtcbiAgc3RhdGljIHRyYW5zZm9ybShlbGUsIHgsIHkpIHtcbiAgICBlbGUuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVkoJHt5fXB4KWA7XG4gIH1cbn1cbmV4cG9ydCBkZWZhdWx0IEFjdGlvbjtcbiIsImNvbnN0IGdldFN0eWxlID0gKGVsZSwgYXR0cikgPT4ge1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWZcbiAgcmV0dXJuIGRvY3VtZW50LmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUoZWxlKVthdHRyXTtcbn07XG5jb25zdCBzZXRTdHlsZSA9IChlbGUsIGRhdGEpID0+IHtcbiAgbGV0IGF0dHIgPSBPYmplY3Qua2V5cyhkYXRhKVswXSxcbiAgICB2YWx1ZSA9IGRhdGFbYXR0cl07XG4gIGVsZS5zdHlsZVthdHRyXSA9IHZhbHVlO1xufTtcbmNvbnN0IGdldFdpZHRoID0gKGVsZSkgPT4ge1xuICByZXR1cm4gZWxlLmNsaWVudFdpZHRoO1xufTtcbmNvbnN0IGdldEhlaWdodCA9IChlbGUpID0+IHtcbiAgcmV0dXJuIGVsZS5jbGllbnRIZWlnaHQ7XG59O1xuY29uc3QgZ2V0V2lkdGhBbmRIZWlnaHQgPSAoZWxlKSA9PiB7XG4gIHJldHVybiBbXG4gICAgZ2V0V2lkdGgoZWxlKSxcbiAgICBnZXRIZWlnaHQoZWxlKVxuICBdO1xufTtcbmNvbnN0IGdldFdpZHRoV2l0aEJvcmRlciA9IChlbGUpID0+IHtcbiAgcmV0dXJuIGVsZS5vZmZzZXRXaWR0aDtcbn07XG5jb25zdCBnZXRIZWlnaHRXaXRoQm9yZGVyID0gKGVsZSkgPT4ge1xuICByZXR1cm4gZWxlLm9mZnNldEhlaWdodDtcbn07XG5cbmNvbnN0IGdldFdpZHRoQW5kSGVpZ2h0V2l0aEJvcmRlciA9IChlbGUpID0+IHtcbiAgcmV0dXJuIFtcbiAgICBnZXRXaWR0aFdpdGhCb3JkZXIoZWxlKSxcbiAgICBnZXRIZWlnaHRXaXRoQm9yZGVyKGVsZSlcbiAgXTtcbn07XG5leHBvcnQge1xuICBnZXRTdHlsZSxcbiAgc2V0U3R5bGUsXG4gIGdldFdpZHRoLFxuICBnZXRIZWlnaHQsXG4gIGdldFdpZHRoQW5kSGVpZ2h0LFxuICBnZXRXaWR0aFdpdGhCb3JkZXIsXG4gIGdldEhlaWdodFdpdGhCb3JkZXIsXG4gIGdldFdpZHRoQW5kSGVpZ2h0V2l0aEJvcmRlclxufTtcbiIsImltcG9ydCBBY3Rpb24gZnJvbSBcIi4uL2FjdGlvbi9pbmRleFwiO1xuaW1wb3J0IHtnZXRXaWR0aEFuZEhlaWdodCwgZ2V0V2lkdGhBbmRIZWlnaHRXaXRoQm9yZGVyfSBmcm9tIFwiLi4vLi4vdXRpbHMvaW5kZXhcIjtcblxuY2xhc3MgVG91Y2hUcmFjZSB7XG4gIGNvbnN0cnVjdG9yKGVsZSkge1xuICAgIHRoaXMuZWxlID0gZWxlO1xuICAgIHRoaXMuaW5pdCgpO1xuICB9XG4gIGluaXQoKSB7XG4gICAgdGhpcy54ID0gMDtcbiAgICB0aGlzLnkgPSAwO1xuICAgIHRoaXMucG9zaXRpb24gPSB7fTtcbiAgICB0aGlzLmV2ZW50cyA9IFtcbiAgICAgIFwidG91Y2hzdGFydFwiLFxuICAgICAgXCJ0b3VjaG1vdmVcIixcbiAgICAgIFwidG91Y2hlbmRcIixcbiAgICAgIFwidG91Y2hjYW5jZWxcIlxuICAgIF07XG4gICAgbGV0IFsgcGFyZW50V2lkdGgscGFyZW50SGVpZ2h0IF0gPSBnZXRXaWR0aEFuZEhlaWdodCh0aGlzLmVsZS5wYXJlbnRFbGVtZW50KSxcbiAgICAgIFtjaGlsZFdpZHRoLCBjaGlsZEhlaWdodCBdID0gZ2V0V2lkdGhBbmRIZWlnaHRXaXRoQm9yZGVyKHRoaXMuZWxlKTtcbiAgICB0aGlzLm1heFkgPSBwYXJlbnRIZWlnaHQgLSBjaGlsZEhlaWdodDtcbiAgICB0aGlzLm1heFggPSBwYXJlbnRXaWR0aCAtIGNoaWxkV2lkdGg7XG4gIH1cbiAgaGFuZGxlRXZlbnQoZXZlbnQpIHtcbiAgICB0aGlzLmdlbmVyYXRlUG9zaXRpb25Gcm9tRXZlbnQoZXZlbnQpO1xuICAgIHN3aXRjaCAoZXZlbnQudHlwZSkge1xuICAgIGNhc2UgXCJ0b3VjaHN0YXJ0XCI6IHtcbiAgICAgIGxldCBzdGFydFggPSB0aGlzLnBvc2l0aW9uLnBhZ2VYLFxuICAgICAgICBzdGFydFkgPSB0aGlzLnBvc2l0aW9uLnBhZ2VZO1xuICAgICAgdGhpcy5wb3NpdGlvbi5zdGFydFggPSBzdGFydFg7XG4gICAgICB0aGlzLnBvc2l0aW9uLnN0YXJ0WSA9IHN0YXJ0WTtcbiAgICB9YnJlYWs7XG4gICAgY2FzZSBcInRvdWNobW92ZVwiOiB7XG4gICAgICBsZXQgbW92ZVggPSB0aGlzLnBvc2l0aW9uLnBhZ2VYLFxuICAgICAgICBtb3ZlWSA9IHRoaXMucG9zaXRpb24ucGFnZVksXG4gICAgICAgIGRlbHRhWCA9IG1vdmVYIC0gdGhpcy5wb3NpdGlvbi5zdGFydFgsXG4gICAgICAgIGRlbHRhWSA9IG1vdmVZIC0gdGhpcy5wb3NpdGlvbi5zdGFydFk7XG4gICAgICB0aGlzLnBvc2l0aW9uLnN0YXJ0WCA9IG1vdmVYO1xuICAgICAgdGhpcy5wb3NpdGlvbi5zdGFydFkgPSBtb3ZlWTtcbiAgICAgIHRoaXMueCA9IHRoaXMueCArIGRlbHRhWDtcbiAgICAgIHRoaXMueSA9IHRoaXMueSArIGRlbHRhWTtcbiAgICAgIGlmKHRoaXMueSA8IHRoaXMubWF4WSkge1xuICAgICAgICB0aGlzLnkgPSB0aGlzLm1heFk7XG4gICAgICB9XG4gICAgICBpZih0aGlzLnkgPiAwKSB7XG4gICAgICAgIHRoaXMueSA9IDA7XG4gICAgICB9XG4gICAgICBBY3Rpb24udHJhbnNmb3JtKHRoaXMuZWxlLCB0aGlzLngsIHRoaXMueSk7XG4gICAgfWJyZWFrO1xuICAgIGNhc2UgXCJ0b3VjaGVuZFwiOlxuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcInRvdWNoY2FuY2VsXCI6XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cbiAgZ2VuZXJhdGVQb3NpdGlvbkZyb21FdmVudChldmVudCkge1xuICAgIGxldCBkYXRhID0gZXZlbnQudG91Y2hlc1swXTtcbiAgICB0aGlzLnBvc2l0aW9uLnBhZ2VYID0gZGF0YS5wYWdlWDtcbiAgICB0aGlzLnBvc2l0aW9uLnBhZ2VZID0gZGF0YS5wYWdlWTtcbiAgfVxuICBsaXN0ZW4oKSB7XG4gICAgdGhpcy5ldmVudHMuZm9yRWFjaChldmVudCA9PiB7XG4gICAgICB0aGlzLmVsZS5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCB0aGlzKTtcbiAgICB9KTtcbiAgfVxufVxuZXhwb3J0IGRlZmF1bHQgVG91Y2hUcmFjZTtcbiIsImltcG9ydCBUb3VjaFRyYWNlIGZyb20gXCIuL2NvcmUvdHJhY2UvaW5kZXguanNcIjtcbmNvbnN0IHZpYiA9IHtcbiAgYmVnaW46IChlbGUpID0+IHtcbiAgICBsZXQgdG91Y2hUcmFjZSA9IG5ldyBUb3VjaFRyYWNlKGVsZSk7XG4gICAgdG91Y2hUcmFjZS5saXN0ZW4oKTtcbiAgfVxufTtcbmV4cG9ydCBkZWZhdWx0IHZpYjtcbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU0sTUFBTSxDQUFDO0FBQ2IsRUFBRSxPQUFPLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRTtBQUM5QixJQUFJLEdBQUcsQ0FBQyxLQUFLLENBQUMsU0FBUyxHQUFHLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUMvQyxHQUFHO0FBQ0g7O0FDS0EsTUFBTSxRQUFRLEdBQUcsQ0FBQyxHQUFHLEtBQUs7QUFDMUIsRUFBRSxPQUFPLEdBQUcsQ0FBQyxXQUFXLENBQUM7QUFDekIsQ0FBQyxDQUFDO0FBQ0YsTUFBTSxTQUFTLEdBQUcsQ0FBQyxHQUFH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
